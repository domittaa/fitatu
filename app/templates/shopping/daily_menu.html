{% extends 'base.html' %}
{% block app_content %}
    <h1>Add meal:</h1>
    <form action="" method="post">
        {{ form.hidden_tag() }}
        <p>
            {{ form.name.label }}<br>
            {{ form.name(size=32) }}
        </p>
        <p>
            {{ form.products.label }}<br>
            {{ form.products(size=32) }}<br>
            {% for error in form.products.errors %}
            <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
        </p>
        <p>
            {{ form.category.label }}<br>
            {{ form.category() }}
        </p>
        <p>
            {{ form.submit() }}
        </p>
    </form>

    <h3>Meal Plan for {{ date }}: </h3>
    <table>
    <tr>
        <th></th>
        <th>Name</th>
        <th>Ingredients</th>
        <th>In fridge</th>
        <th>Must buy</th>
        <th>Delete</th>
    </tr>
    <tr>
        {% for dish in dishes %}
            {% if dish.category == 'Breakfast' %}
            <th>Breakfast</th>
                <td>
                    {{ dish.name }}<br>
                </td>
                <td>
                    {{ dish.products }}
                </td>
                <td>
                    {{ ", ".join(in_fridge['Breakfast'])  }} <br>
                </td>
                <td>
                    {{", ".join(must_buy['Breakfast']) }}
                </td>
                <td>
                    <a href="{{ url_for('shopping.delete_menu', id= dish.id) }}">Delete</a>
                </td>
                </tr>
            {% endif %}
            {% endfor %}
        <tr>
        {% for dish in dishes %}
            {% if dish.category == 'Second breakfast' %}
            <th>Second breakfast</th>
            <td>
                {{ dish.name }}
            </td>
            <td>
                {{ dish.products }}
            </td>
            <td>
                {{ ", ".join(in_fridge['Second breakfast'])  }} <br>
            </td>
            <td>
                {{", ".join(must_buy['Second breakfast']) }}
            </td>
            <td>
                <a href="{{ url_for('shopping.delete_menu', id= dish.id) }}">Delete</a>
            </td>
            {% endif %}
        {% endfor %}
        </tr>
        <tr>
            {% for dish in dishes %}
                {% if dish.category == 'Lunch' %}
                <th>Lunch</th>
                <td>
                    {{ dish.name }}
                </td>
                <td>
                    {{ dish.products }}
                </td>
                <td>
                    {{ ", ".join(in_fridge['Lunch']) }} <br>
                </td>
                <td>
                    {{ ", ".join(must_buy['Lunch']) }}
                </td>
                <td>
                    <a href="{{ url_for('shopping.delete_menu', id= dish.id) }}">Delete</a>
                </td>
                {% endif %}
            {% endfor %}
        </tr>
        <tr>
             {% for dish in dishes %}
                {% if dish.category == 'Dessert' %}
                    <th>Dessert</th>
                <td>
                    {{ dish.name }}
                </td>
                <td>
                    {{ dish.products }}
                </td>
                <td>
                    {{ ", ".join(in_fridge['Dessert']) }} <br>
                </td>
                <td>
                    {{ ", ".join(must_buy['Dessert']) }}
                </td>
                <td>
                    <a href="{{ url_for('shopping.delete_menu', id= dish.id) }}">Delete</a>
                </td>
            {% endif %}
            {% endfor %}
        </tr>
        <tr>
            {% for dish in dishes %}
                {% if dish.category == 'Dinner' %}
                <th>Dinner</th>
                <td>
                    {{ dish.name }}
                </td>
                <td>
                    {{ dish.products }}
                </td>
                <td>
                    {{ ", ".join(in_fridge['Dinner'])  }} <br>
                </td>
                <td>
                    {{ ", ".join(must_buy['Dinner']) }}
                </td>
                <td>
                    <a href="{{ url_for('shopping.delete_menu', id= dish.id) }}">Delete</a>
            </td>
            {% endif %}
            {% endfor %}
        </tr>
    </table>
    <br>
    <a href="{{ url_for('shopping.week_menu') }}">Back to week menu</a>
{% endblock %}