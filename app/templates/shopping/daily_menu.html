{% extends 'base.html' %}
{% block app_content %}
    <h1>Add meal:</h1>
    <form action="" method="post">
        {{ form.hidden_tag() }}
        <p>
            {{ form.category.label }}<br>
            {{ form.category(class='select') }}
        </p>
        <p>
            {{ form.name.label }}<br>
            {{ form.name(size=32) }}
        </p>
        <p>
            {{ form.products.label }}<br>
            {{ form.products(size=32) }}<br>
            {% for error in form.products.errors %}
            <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
        </p>
        <p>
            {{ form.submit() }}
        </p>
    </form>

    <h3>Meal Plan for {{ date }}: </h3>
    <table>
    <tr>
        <th></th>
        <th>Name</th>
        <th>Ingredients</th>
        <th>In fridge</th>
        <th>Must buy</th>
        <th>Delete</th>
    </tr>
    <tr>
        {% for dish in dishes %}
            {% if dish.category == 'Breakfast' %}
            <th>Breakfast</th>
                <td>
                    {{ dish.name }}<br>
                </td>
                <td>
                    {{ dish.products }}
                </td>
                <td>
                    {{ ", ".join(in_fridge['Breakfast'])  }} <br>
                </td>
                <td>
                    {{", ".join(must_buy['Breakfast']) }}
                </td>
                <td>
                    <a href="{{ url_for('shopping.delete_menu', id= dish.id) }}">Delete</a>
                </td>
                </tr>
            {% endif %}
            {% endfor %}
        <tr>
        {% for dish in dishes %}
            {% if dish.category == 'Second breakfast' %}
            <th>Second breakfast</th>
            <td>
                {{ dish.name }}
            </td>
            <td>
                {{ dish.products }}
            </td>
            <td>
                {{ ", ".join(in_fridge['Second breakfast'])  }} <br>
            </td>
            <td>
                {{", ".join(must_buy['Second breakfast']) }}
            </td>
            <td>
                <a href="{{ url_for('shopping.delete_menu', id= dish.id) }}">Delete</a>
            </td>
            {% endif %}
        {% endfor %}
        </tr>
        <tr>
            {% for dish in dishes %}
                {% if dish.category == 'Lunch' %}
                <th>Lunch</th>
                <td>
                    {{ dish.name }}
                </td>
                <td>
                    {{ dish.products }}
                </td>
                <td>
                    {{ ", ".join(in_fridge['Lunch']) }} <br>
                </td>
                <td>
                    {{ ", ".join(must_buy['Lunch']) }}
                </td>
                <td>
                    <a href="{{ url_for('shopping.delete_menu', id= dish.id) }}">Delete</a>
                </td>
                {% endif %}
            {% endfor %}
        </tr>
        <tr>
             {% for dish in dishes %}
                {% if dish.category == 'Dessert' %}
                    <th>Dessert</th>
                <td>
                    {{ dish.name }}
                </td>
                <td>
                    {{ dish.products }}
                </td>
                <td>
                    {{ ", ".join(in_fridge['Dessert']) }} <br>
                </td>
                <td>
                    {{ ", ".join(must_buy['Dessert']) }}
                </td>
                <td>
                    <a href="{{ url_for('shopping.delete_menu', id= dish.id) }}">Delete</a>
                </td>
            {% endif %}
            {% endfor %}
        </tr>
        <tr>
            {% for dish in dishes %}
                {% if dish.category == 'Dinner' %}
                <th>Dinner</th>
                <td>
                    {{ dish.name }}
                </td>
                <td>
                    {{ dish.products }}
                </td>
                <td>
                    {{ ", ".join(in_fridge['Dinner'])  }} <br>
                </td>
                <td>
                    {{ ", ".join(must_buy['Dinner']) }}
                </td>
                <td>
                    <a href="{{ url_for('shopping.delete_menu', id= dish.id) }}">Delete</a>
            </td>
            {% endif %}
            {% endfor %}
        </tr>
    </table>
    <br>
    <a href="{{ url_for('shopping.week_menu') }}">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-arrow-left-square" viewBox="0 0 16 16">
    <path fill-rule="evenodd" d="M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm11.5 5.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z"/></svg>
    </a>
{% endblock %}